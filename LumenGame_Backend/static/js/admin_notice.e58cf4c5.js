(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["admin_notice"],{"05a9":function(e,t,i){},"1b62":function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var r=i("1da1"),n=(i("96cf"),{data:function(){return{query:{page:1,size:10,keyword:null},total:0}},methods:{handleSizeChange:function(e,t){this.query.size=t,e()},handleCurrentChange:function(e,t){this.query.page=t,e()},clearIpt:function(e){this.query.keyword=null,e()},deleteById:function(e,t,i,n){var o=this;this.$confirm("此操作将永久删除该"+n+", 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"error",center:!0}).then(Object(r["a"])(regeneratorRuntime.mark((function r(){var n,a,s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,e(i);case 2:n=r.sent,a=n.success,s=n.message,a?(o.$message.success("删除成功"),t()):o.$message.error(s);case 6:case"end":return r.stop()}}),r)})))).catch((function(){o.$message.info("已取消删除")}))},clearDialog:function(e){this.$refs[e].resetFields()},showMsgBySuccess:function(e,t,i){e?(this.$message.success("".concat(t,"成功!")),i()):this.$message.error("".concat(t,"失败!"))}}})},7308:function(e,t,i){"use strict";i.r(t);var r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"notice"},[i("el-card",[i("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[i("el-breadcrumb-item",{attrs:{to:{path:"/"}}},[e._v("首页")]),i("el-breadcrumb-item",[e._v("公告管理")]),i("el-breadcrumb-item",[e._v("公告列表")])],1),i("el-divider"),i("el-row",{staticClass:"top-search",attrs:{gutter:20}},[i("el-col",{attrs:{span:6}},[i("el-input",{staticClass:"search-ipt",attrs:{placeholder:"请输入内容",clearable:!0},on:{clear:function(t){return e.fetchNotice()}},nativeOn:{keyup:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.fetchNotice()},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"])?null:e.clearIpt(e.fetchNotice)}]},model:{value:e.query.keyword,callback:function(t){e.$set(e.query,"keyword",t)},expression:"query.keyword"}},[i("i",{staticClass:"el-input__icon el-icon-search search-icon",attrs:{slot:"prefix"},slot:"prefix"})])],1),i("el-col",{attrs:{span:6,offset:12}},[i("el-button",{staticClass:"el-icon-circle-plus-outline add-button",attrs:{size:"medium"},on:{click:function(t){return e.showNoticeDialog(0)}}},[e._v("发布公告 ")]),i("span")],1)],1),i("el-table",{staticStyle:{width:"100%"},attrs:{data:e.noticeList,stripe:""}},[i("el-table-column",{attrs:{prop:"title",label:"标题","min-width":"180"}}),i("el-table-column",{attrs:{prop:"comment",label:"简介","min-width":"180"}}),i("el-table-column",{attrs:{prop:"createTime",label:"创建时间","min-width":"180"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[e._v(" "+e._s(e._f("formatDate")(i.createTime))+" ")]}}])}),i("el-table-column",{attrs:{prop:"updateTime",label:"更新时间","min-width":"180"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[e._v(" "+e._s(e._f("formatDate")(i.updateTime))+" ")]}}])}),i("el-table-column",{attrs:{prop:"address",label:"操作","min-width":"180"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[i("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.showNoticeDialog(1,r)}}},[e._v("编辑 ")]),i("el-button",{attrs:{type:"success",size:"small"},on:{click:function(t){return e.showNoticeDetailDialog(r)}}},[e._v("详情 ")]),i("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(t){return e.deleteById(e._deleteNotice,e.fetchNotice,r.id,"公告")}}},[e._v("删除 ")])]}}])})],1),i("el-pagination",{attrs:{"page-sizes":[1,2,5,10],layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":function(t){return e.handleSizeChange(e.fetchNotice,t)},"current-change":function(t){return e.handleCurrentChange(e.fetchNotice,t)}}})],1),i("el-dialog",{staticClass:"notice-dialog",attrs:{title:0===e.noticeForm.flag?"发布公告":"修改公告",visible:e.noticeDialogVisible,width:"30%"},on:{"update:visible":function(t){e.noticeDialogVisible=t},close:function(t){return e.clearDialog("noticeForm")}}},[i("el-form",{ref:"noticeForm",staticClass:"notice-form",attrs:{model:e.noticeForm,rules:e.noticeRules,"hide-required-asterisk":!0}},[i("el-form-item",{attrs:{label:"公告标题",prop:"title"}},[i("el-input",{model:{value:e.noticeForm.title,callback:function(t){e.$set(e.noticeForm,"title",t)},expression:"noticeForm.title"}})],1),i("el-form-item",{attrs:{label:"公告简介",prop:"comment"}},[i("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4},placeholder:"请输入内容",resize:"none"},model:{value:e.noticeForm.comment,callback:function(t){e.$set(e.noticeForm,"comment",t)},expression:"noticeForm.comment"}})],1),i("el-form-item",{attrs:{label:"公告封面",prop:"url"}},[i("el-upload",{staticClass:"avatar-uploader",attrs:{action:e.bindURL("/uploadfile"),"show-file-list":!1,"on-success":e.handleAvatarSuccess,name:"files"}},[e.noticeForm.url?i("img",{staticClass:"avatar",attrs:{src:e.bindURL(e.noticeForm.url)}}):i("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1)],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"small"},on:{click:function(t){e.noticeDialogVisible=!1}}},[e._v("取 消")]),i("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.submitNotice(e.noticeForm.flag)}}},[e._v(" "+e._s(["发 布","修 改"][e.noticeForm.flag])+" ")])],1)],1),i("el-dialog",{attrs:{visible:e.noticeDetailDialogVisible,width:"30%"},on:{"update:visible":function(t){e.noticeDetailDialogVisible=t}}},[i("div",{staticClass:"d-head"},[i("span",{staticClass:"d-title"},[e._v(e._s(e.currentNotice.title))]),i("span",{staticClass:"d-date"},[e._v(e._s(e._f("formatDate")(e.currentNotice.createTime)))])]),i("div",{staticClass:"d-main"},[i("div",{domProps:{innerHTML:e._s(e.currentNotice.comment)}})])])],1)},n=[],o=i("1da1"),a=(i("96cf"),i("1b62")),s=i("365c"),c=i("ed08"),l=0,u=1,m={data:function(){return{noticeList:[],noticeDialogVisible:!1,noticeDetailDialogVisible:!1,noticeForm:{},noticeRules:{title:[{required:!0,message:"输入公告标题",trigger:"blur"}],comment:[{required:!0,message:"输入公告内容",trigger:"blur"}],url:[{required:!0,message:"选择公告封面",trigger:"blur"}]},currentNotice:{}}},methods:{_deleteNotice:s["_deleteNotice"],bindURL:c["a"],fetchNotice:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var i,r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(s["_getNoticeList"])(e.query);case 2:i=t.sent,r=i.list,n=i.total,e.noticeList=r,e.total=n;case 7:case"end":return t.stop()}}),t)})))()},showNoticeDialog:function(e,t){this.noticeDialogVisible=!0,e===l||(e===u?this.noticeForm=Object(c["b"])(t):console.log("error")),this.noticeForm.flag=e},handleAvatarSuccess:function(e){this.$set(this.noticeForm,"url",e)},submitNotice:function(e){var t=this;this.$refs.noticeForm.validate(function(){var i=Object(o["a"])(regeneratorRuntime.mark((function i(r){var n,o,a,c;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(r){i.next=2;break}return i.abrupt("return");case 2:if(t.noticeForm.updateTime=Date.now(),e!==l){i.next=12;break}return t.noticeForm.id=Date.now()%999999999,i.next=7,Object(s["_addNotice"])(t.noticeForm);case 7:n=i.sent,o=n.success,o?t.$message.success("发布成功"):t.$message.error("发布失败"),i.next=21;break;case 12:if(e!==u){i.next=20;break}return i.next=15,Object(s["_editNotice"])(t.noticeForm);case 15:a=i.sent,c=a.success,c?t.$message.success("修改成功"):t.$message.error("修改失败"),i.next=21;break;case 20:console.log("error");case 21:t.fetchNotice(),t.noticeDialogVisible=!1;case 23:case"end":return i.stop()}}),i)})));return function(e){return i.apply(this,arguments)}}())},showNoticeDetailDialog:function(e){this.currentNotice=Object(c["b"])(e),this.noticeDetailDialogVisible=!0}},mixins:[a["a"]],created:function(){this.fetchNotice()}},d=m,f=(i("b125"),i("2877")),p=Object(f["a"])(d,r,n,!1,null,"55001f72",null);t["default"]=p.exports},b125:function(e,t,i){"use strict";i("05a9")}}]);
//# sourceMappingURL=admin_notice.e58cf4c5.js.map