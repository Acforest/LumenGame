(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["admin_addPost"],{"39df":function(t,e,a){},"44ca":function(t,e,a){"use strict";a("39df")},"965d":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"addPost"},[a("el-card",[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/"}}},[t._v("首页")]),a("el-breadcrumb-item",{attrs:{to:{path:"/_post"}}},[t._v("帖子管理")]),a("el-breadcrumb-item",[t.id?[t._v(" 修改帖子 ")]:[t._v(" 发布帖子 ")]],2)],1),a("el-divider"),a("el-row",{staticClass:"top-search",attrs:{gutter:20}},[a("el-col",{attrs:{span:6}},[a("el-input",{attrs:{placeholder:"请输入文章标题"},model:{value:t.postData.title,callback:function(e){t.$set(t.postData,"title",e)},expression:"postData.title"}})],1),a("el-col",{attrs:{span:6,offset:12}},[t.id?[a("el-button",{staticClass:"el-icon-edit-outline add-button",attrs:{size:"medium"},on:{click:function(e){return t.submitPost(1)}}},[t._v(" 修改帖子 ")])]:[a("el-button",{staticClass:"el-icon-edit-outline add-button",attrs:{size:"medium"},on:{click:function(e){return t.submitPost(0)}}},[t._v(" 发布帖子 ")])]],2)],1),a("mavon-editor",{ref:"md-editor",staticStyle:{"min-height":"560px"},on:{imgAdd:t.handleEditorImgAdd},model:{value:t.postData.textContent,callback:function(e){t.$set(t.postData,"textContent",e)},expression:"postData.textContent"}})],1)],1)},r=[],n=a("5530"),o=a("1da1"),i=(a("96cf"),a("b2d8")),c=(a("64e1"),a("ed08")),u=a("365c"),d=a("2f62"),l=0,p=1,m={props:{id:String},data:function(){return{postData:{textContent:"",htmlContent:"",title:""}}},components:{mavonEditor:i["mavonEditor"]},methods:{submitPost:function(t){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){var s,r,n,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(e.validatePost()){a.next=2;break}return a.abrupt("return");case 2:if(e.postData.htmlContent=Object(c["d"])(e.postData.textContent),e.postData.authorId=e.currentUser.id,t!==p){a.next=13;break}return e.postData.updateTime=Date.now(),a.next=8,Object(u["_editPost"])(e.postData);case 8:s=a.sent,r=s.success,r?(e.$message.success("修改成功"),e.$router.push("/_post")):e.$message.error("修改失败"),a.next=19;break;case 13:if(t!==l){a.next=19;break}return a.next=16,Object(u["_addPost"])(e.postData);case 16:n=a.sent,o=n.success,o?(e.$message.success("发布成功"),e.$router.push("/_post")):e.$message.error("发布失败");case 19:case"end":return a.stop()}}),a)})))()},handleEditorImgAdd:function(t,e){var a=this;return Object(o["a"])(regeneratorRuntime.mark((function s(){var r,n;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return r=new FormData,r.append("files",e),s.next=4,Object(u["J"])(r);case 4:n=s.sent,a.$refs["md-editor"].$img2Url(t,Object(c["a"])(n));case 6:case"end":return s.stop()}}),s)})))()},validatePost:function(){return 0===this.postData.title.length?(this.$message.error("请输入文章标题"),!1):0!==this.postData.textContent.length||(this.$message.error("请输入文章内容"),!1)}},computed:Object(n["a"])({},Object(d["e"])(["currentUser","currentPost"])),created:function(){this.id&&(this.postData=this.currentPost)}},b=m,f=(a("44ca"),a("2877")),h=Object(f["a"])(b,s,r,!1,null,"69f6e48e",null);e["default"]=h.exports}}]);
//# sourceMappingURL=admin_addPost.01b566ae.js.map